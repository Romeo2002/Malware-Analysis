def find_function_arg(addr):
    addrPrev = idc.PrevHead(addr.frm)
    while True:
        if GetMnem(addrPrev) == "mov" and "ecx" in GetOpnd(addrPrev,0):
            return GetOperandValue(addrPrev,1)
            break
        addrPrev = idc.PrevHead(addrPrev)

def get_string(addr):
  out = ""
  while True:
    if Byte(addr) != 0:
      out += chr(Byte(addr))
    else:
      break
    addr += 1
  return out

def decrypt(data):
    print len(data)



for addr in XrefsTo(0x402C60, flags=0):
    print hex(find_function_arg(addr))
string = get_string(0x40ABE0)
decrypt(string)
