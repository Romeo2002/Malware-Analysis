#define _CRT_SECURE_NO_WARNINGS
#include <Windows.h>
#include <string.h>
#include <wincrypt.h>
#include <stdio.h>
#include <Winerror.h>




using namespace std;

int main(void)
{
    char MyMachineID[] = "a0b44547-d379-4c1b-a8c9-2b9648033751";
    HCRYPTPROV hMyCSP = NULL;
    HCRYPTHASH hMyHash;
    BYTE HashValue[16] = { };
    DWORD pdwDataLen = sizeof(HashValue);
    if (!CryptAcquireContextA(&hMyCSP, NULL, NULL, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT)) {
        printf("Error ID: %d\n", GetLastError());
        return 1;
    }
    else {
        printf("Successsfully Acquire Cryptographic context\n");
    }

    CryptCreateHash(hMyCSP, CALG_MD5, NULL, 0, &hMyHash);

    CryptHashData(hMyHash, (const BYTE*) MyMachineID, strlen(MyMachineID), 0);

    CryptGetHashParam(hMyHash, HP_HASHVAL, HashValue,&pdwDataLen,0);

    for (int i = 0; i < 16; i++) {
        printf("%x", HashValue[i]);
    }

    CryptDestroyHash(hMyHash);

    if (CryptReleaseContext(hMyCSP, 0)) {
        printf("\nSuccessfully release Crypt context\n");
    }
    else
    {
        printf("Failure to release the crypt context!\n");
        return 1;
    }



    return 0;

}
